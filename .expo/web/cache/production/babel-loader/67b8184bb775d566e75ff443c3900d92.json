{"ast":null,"code":"import _extends from\"@babel/runtime/helpers/extends\";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}import{canUseDOM}from'fbjs/lib/ExecutionEnvironment';import createReactDOMStyle from\"./createReactDOMStyle\";import flattenArray from\"../../modules/flattenArray\";import flattenStyle from\"./flattenStyle\";import I18nManager from\"../I18nManager\";import i18nStyle from\"./i18nStyle\";import{prefixInlineStyles}from\"../../modules/prefixStyles\";import StyleSheetManager from\"./StyleSheetManager\";var emptyObject={};var ReactNativeStyleResolver=function(){ReactNativeStyleResolver.prototype._init=function _init(){this.cache={ltr:{},rtl:{},rtlNoSwap:{}};this.injectedCache={ltr:{},rtl:{},rtlNoSwap:{}};this.styleSheetManager=new StyleSheetManager();};function ReactNativeStyleResolver(){_classCallCheck(this,ReactNativeStyleResolver);this._init();}ReactNativeStyleResolver.prototype.getStyleSheet=function getStyleSheet(){var sheet=this.styleSheetManager.getStyleSheet();if(!canUseDOM){this._init();}return sheet;};ReactNativeStyleResolver.prototype._injectRegisteredStyle=function _injectRegisteredStyle(id){var _this=this;var doLeftAndRightSwapInRTL=I18nManager.doLeftAndRightSwapInRTL,isRTL=I18nManager.isRTL;var dir=isRTL?doLeftAndRightSwapInRTL?'rtl':'rtlNoSwap':'ltr';if(!this.injectedCache[dir][id]){var style=flattenStyle(id);var domStyle=createReactDOMStyle(i18nStyle(style));Object.keys(domStyle).forEach(function(styleProp){var value=domStyle[styleProp];if(value!=null){_this.styleSheetManager.injectDeclaration(styleProp,value);}});this.injectedCache[dir][id]=true;}};ReactNativeStyleResolver.prototype.resolve=function resolve(style){if(!style){return emptyObject;}if(typeof style==='number'){this._injectRegisteredStyle(style);var _key=createCacheKey(style);return this._resolveStyleIfNeeded(style,_key);}if(!Array.isArray(style)){return this._resolveStyleIfNeeded(style);}var flatArray=flattenArray(style);var isArrayOfNumbers=true;for(var i=0;i<flatArray.length;i++){var id=flatArray[i];if(typeof id!=='number'){isArrayOfNumbers=false;}else{this._injectRegisteredStyle(id);}}var key=isArrayOfNumbers?createCacheKey(flatArray.join('-')):null;return this._resolveStyleIfNeeded(flatArray,key);};ReactNativeStyleResolver.prototype.resolveWithNode=function resolveWithNode(rnStyleNext,node){var _this2=this;var _getDOMStyleInfo=getDOMStyleInfo(node),rdomClassList=_getDOMStyleInfo.classList,rdomStyle=_getDOMStyleInfo.style;var _rdomClassList$reduce=rdomClassList.reduce(function(styleProps,className){var _styleSheetManager$ge=_this2.styleSheetManager.getDeclaration(className),prop=_styleSheetManager$ge.prop,value=_styleSheetManager$ge.value;if(prop){styleProps.style[prop]=value;}else{styleProps.classList.push(className);}return styleProps;},{classList:[],style:{}}),rnClassList=_rdomClassList$reduce.classList,rnStyle=_rdomClassList$reduce.style;var _resolve=this.resolve([i18nStyle(rnStyle),rnStyleNext]),rdomClassListNext=_resolve.classList,rdomStyleNext=_resolve.style;var className=classListToString(rdomClassListNext.concat(rnClassList));var style=_extends({},rdomStyle);rdomClassListNext.forEach(function(className){var _styleSheetManager$ge2=_this2.styleSheetManager.getDeclaration(className),prop=_styleSheetManager$ge2.prop;if(style[prop]){style[prop]='';}});_extends(style,rdomStyleNext);return{className:className,style:style};};ReactNativeStyleResolver.prototype._resolveStyle=function _resolveStyle(style){var _this3=this;var flatStyle=flattenStyle(style);var domStyle=createReactDOMStyle(i18nStyle(flatStyle));var props=Object.keys(domStyle).reduce(function(props,styleProp){var value=domStyle[styleProp];if(value!=null){var className=_this3.styleSheetManager.getClassName(styleProp,value);if(className){props.classList.push(className);}else{if(styleProp==='pointerEvents'||styleProp==='placeholderTextColor'||styleProp==='animationName'){var _className=_this3.styleSheetManager.injectDeclaration(styleProp,value);if(_className){props.classList.push(_className);}}else{if(!props.style){props.style={};}props.style[styleProp]=value;}}}return props;},{classList:[]});props.className=classListToString(props.classList);if(props.style){props.style=prefixInlineStyles(props.style);}return props;};ReactNativeStyleResolver.prototype._resolveStyleIfNeeded=function _resolveStyleIfNeeded(style,key){if(key){var doLeftAndRightSwapInRTL=I18nManager.doLeftAndRightSwapInRTL,isRTL=I18nManager.isRTL;var dir=isRTL?doLeftAndRightSwapInRTL?'rtl':'rtlNoSwap':'ltr';if(!this.cache[dir][key]){this.cache[dir][key]=this._resolveStyle(style);}return this.cache[dir][key];}return this._resolveStyle(style);};return ReactNativeStyleResolver;}();export default ReactNativeStyleResolver;var createCacheKey=function createCacheKey(id){var prefix='rn';return prefix+'-'+id;};var classListToString=function classListToString(list){return list.join(' ').trim();};var hyphenPattern=/-([a-z])/g;var toCamelCase=function toCamelCase(str){return str.replace(hyphenPattern,function(m){return m[1].toUpperCase();});};var getDOMStyleInfo=function getDOMStyleInfo(node){var nodeStyle=node.style;var classList=Array.prototype.slice.call(node.classList);var style={};for(var i=0;i<nodeStyle.length;i+=1){var property=nodeStyle.item(i);if(property){style[toCamelCase(property)]=nodeStyle.getPropertyValue(property);}}return{classList:classList,style:style};};","map":{"version":3,"sources":["C:/Users/arnol/code/entroprise/node_modules/react-web-gifted-chat/node_modules/react-native-web/dist/exports/StyleSheet/ReactNativeStyleResolver.js"],"names":["_classCallCheck","instance","Constructor","TypeError","canUseDOM","createReactDOMStyle","flattenArray","flattenStyle","I18nManager","i18nStyle","prefixInlineStyles","StyleSheetManager","emptyObject","ReactNativeStyleResolver","prototype","_init","cache","ltr","rtl","rtlNoSwap","injectedCache","styleSheetManager","getStyleSheet","sheet","_injectRegisteredStyle","id","_this","doLeftAndRightSwapInRTL","isRTL","dir","style","domStyle","Object","keys","forEach","styleProp","value","injectDeclaration","resolve","_key","createCacheKey","_resolveStyleIfNeeded","Array","isArray","flatArray","isArrayOfNumbers","i","length","key","join","resolveWithNode","rnStyleNext","node","_this2","_getDOMStyleInfo","getDOMStyleInfo","rdomClassList","classList","rdomStyle","_rdomClassList$reduce","reduce","styleProps","className","_styleSheetManager$ge","getDeclaration","prop","push","rnClassList","rnStyle","_resolve","rdomClassListNext","rdomStyleNext","classListToString","concat","_styleSheetManager$ge2","_resolveStyle","_this3","flatStyle","props","getClassName","_className","prefix","list","trim","hyphenPattern","toCamelCase","str","replace","m","toUpperCase","nodeStyle","slice","call","property","item","getPropertyValue"],"mappings":"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","sourcesContent":["function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (c) 2016-present, Nicolas Gallagher.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @noflow\n */\n\n/**\n * WARNING: changes to this file in particular can cause significant changes to\n * the results of render performance benchmarks.\n */\n\nimport { canUseDOM } from 'fbjs/lib/ExecutionEnvironment';\nimport createReactDOMStyle from './createReactDOMStyle';\nimport flattenArray from '../../modules/flattenArray';\nimport flattenStyle from './flattenStyle';\nimport I18nManager from '../I18nManager';\nimport i18nStyle from './i18nStyle';\nimport { prefixInlineStyles } from '../../modules/prefixStyles';\nimport StyleSheetManager from './StyleSheetManager';\n\nvar emptyObject = {};\n\nvar ReactNativeStyleResolver = function () {\n  ReactNativeStyleResolver.prototype._init = function _init() {\n    this.cache = { ltr: {}, rtl: {}, rtlNoSwap: {} };\n    this.injectedCache = { ltr: {}, rtl: {}, rtlNoSwap: {} };\n    this.styleSheetManager = new StyleSheetManager();\n  };\n\n  function ReactNativeStyleResolver() {\n    _classCallCheck(this, ReactNativeStyleResolver);\n\n    this._init();\n  }\n\n  ReactNativeStyleResolver.prototype.getStyleSheet = function getStyleSheet() {\n    // reset state on the server so critical css is always the result\n    var sheet = this.styleSheetManager.getStyleSheet();\n    if (!canUseDOM) {\n      this._init();\n    }\n    return sheet;\n  };\n\n  ReactNativeStyleResolver.prototype._injectRegisteredStyle = function _injectRegisteredStyle(id) {\n    var _this = this;\n\n    var doLeftAndRightSwapInRTL = I18nManager.doLeftAndRightSwapInRTL,\n        isRTL = I18nManager.isRTL;\n\n    var dir = isRTL ? doLeftAndRightSwapInRTL ? 'rtl' : 'rtlNoSwap' : 'ltr';\n    if (!this.injectedCache[dir][id]) {\n      var style = flattenStyle(id);\n      var domStyle = createReactDOMStyle(i18nStyle(style));\n      Object.keys(domStyle).forEach(function (styleProp) {\n        var value = domStyle[styleProp];\n        if (value != null) {\n          _this.styleSheetManager.injectDeclaration(styleProp, value);\n        }\n      });\n      this.injectedCache[dir][id] = true;\n    }\n  };\n\n  /**\n   * Resolves a React Native style object to DOM attributes\n   */\n\n\n  ReactNativeStyleResolver.prototype.resolve = function resolve(style) {\n    if (!style) {\n      return emptyObject;\n    }\n\n    // fast and cachable\n    if (typeof style === 'number') {\n      this._injectRegisteredStyle(style);\n      var _key = createCacheKey(style);\n      return this._resolveStyleIfNeeded(style, _key);\n    }\n\n    // resolve a plain RN style object\n    if (!Array.isArray(style)) {\n      return this._resolveStyleIfNeeded(style);\n    }\n\n    // flatten the style array\n    // cache resolved props when all styles are registered\n    // otherwise fallback to resolving\n    var flatArray = flattenArray(style);\n    var isArrayOfNumbers = true;\n    for (var i = 0; i < flatArray.length; i++) {\n      var id = flatArray[i];\n      if (typeof id !== 'number') {\n        isArrayOfNumbers = false;\n      } else {\n        this._injectRegisteredStyle(id);\n      }\n    }\n    var key = isArrayOfNumbers ? createCacheKey(flatArray.join('-')) : null;\n    return this._resolveStyleIfNeeded(flatArray, key);\n  };\n\n  /**\n   * Resolves a React Native style object to DOM attributes, accounting for\n   * the existing styles applied to the DOM node.\n   *\n   * To determine the next style, some of the existing DOM state must be\n   * converted back into React Native styles.\n   */\n\n\n  ReactNativeStyleResolver.prototype.resolveWithNode = function resolveWithNode(rnStyleNext, node) {\n    var _this2 = this;\n\n    var _getDOMStyleInfo = getDOMStyleInfo(node),\n        rdomClassList = _getDOMStyleInfo.classList,\n        rdomStyle = _getDOMStyleInfo.style;\n    // Convert the DOM classList back into a React Native form\n    // Preserves unrecognized class names.\n\n\n    var _rdomClassList$reduce = rdomClassList.reduce(function (styleProps, className) {\n      var _styleSheetManager$ge = _this2.styleSheetManager.getDeclaration(className),\n          prop = _styleSheetManager$ge.prop,\n          value = _styleSheetManager$ge.value;\n\n      if (prop) {\n        styleProps.style[prop] = value;\n      } else {\n        styleProps.classList.push(className);\n      }\n      return styleProps;\n    }, { classList: [], style: {} }),\n        rnClassList = _rdomClassList$reduce.classList,\n        rnStyle = _rdomClassList$reduce.style;\n\n    // Create next DOM style props from current and next RN styles\n\n\n    var _resolve = this.resolve([i18nStyle(rnStyle), rnStyleNext]),\n        rdomClassListNext = _resolve.classList,\n        rdomStyleNext = _resolve.style;\n\n    // Final className\n    // Add the current class names not managed by React Native\n\n\n    var className = classListToString(rdomClassListNext.concat(rnClassList));\n\n    // Final style\n    // Next class names take priority over current inline styles\n    var style = Object.assign({}, rdomStyle);\n    rdomClassListNext.forEach(function (className) {\n      var _styleSheetManager$ge2 = _this2.styleSheetManager.getDeclaration(className),\n          prop = _styleSheetManager$ge2.prop;\n\n      if (style[prop]) {\n        style[prop] = '';\n      }\n    });\n    // Next inline styles take priority over current inline styles\n    Object.assign(style, rdomStyleNext);\n\n    return { className: className, style: style };\n  };\n\n  /**\n   * Resolves a React Native style object\n   */\n\n\n  ReactNativeStyleResolver.prototype._resolveStyle = function _resolveStyle(style) {\n    var _this3 = this;\n\n    var flatStyle = flattenStyle(style);\n    var domStyle = createReactDOMStyle(i18nStyle(flatStyle));\n\n    var props = Object.keys(domStyle).reduce(function (props, styleProp) {\n      var value = domStyle[styleProp];\n      if (value != null) {\n        var className = _this3.styleSheetManager.getClassName(styleProp, value);\n        if (className) {\n          props.classList.push(className);\n        } else {\n          // Certain properties and values are not transformed by 'createReactDOMStyle' as they\n          // require more complex transforms into multiple CSS rules. Here we assume that StyleManager\n          // can bind these styles to a className, and prevent them becoming invalid inline-styles.\n          if (styleProp === 'pointerEvents' || styleProp === 'placeholderTextColor' || styleProp === 'animationName') {\n            var _className = _this3.styleSheetManager.injectDeclaration(styleProp, value);\n            if (_className) {\n              props.classList.push(_className);\n            }\n          } else {\n            if (!props.style) {\n              props.style = {};\n            }\n            // 4x slower render\n            props.style[styleProp] = value;\n          }\n        }\n      }\n      return props;\n    }, { classList: [] });\n\n    props.className = classListToString(props.classList);\n    if (props.style) {\n      props.style = prefixInlineStyles(props.style);\n    }\n    return props;\n  };\n\n  /**\n   * Caching layer over 'resolveStyle'\n   */\n\n\n  ReactNativeStyleResolver.prototype._resolveStyleIfNeeded = function _resolveStyleIfNeeded(style, key) {\n    if (key) {\n      var doLeftAndRightSwapInRTL = I18nManager.doLeftAndRightSwapInRTL,\n          isRTL = I18nManager.isRTL;\n\n      var dir = isRTL ? doLeftAndRightSwapInRTL ? 'rtl' : 'rtlNoSwap' : 'ltr';\n      if (!this.cache[dir][key]) {\n        // slow: convert style object to props and cache\n        this.cache[dir][key] = this._resolveStyle(style);\n      }\n      return this.cache[dir][key];\n    }\n    return this._resolveStyle(style);\n  };\n\n  return ReactNativeStyleResolver;\n}();\n\n/**\n * Misc helpers\n */\n\n\nexport default ReactNativeStyleResolver;\nvar createCacheKey = function createCacheKey(id) {\n  var prefix = 'rn';\n  return prefix + '-' + id;\n};\n\nvar classListToString = function classListToString(list) {\n  return list.join(' ').trim();\n};\n\n/**\n * Copies classList and style data from a DOM node\n */\nvar hyphenPattern = /-([a-z])/g;\nvar toCamelCase = function toCamelCase(str) {\n  return str.replace(hyphenPattern, function (m) {\n    return m[1].toUpperCase();\n  });\n};\n\nvar getDOMStyleInfo = function getDOMStyleInfo(node) {\n  var nodeStyle = node.style;\n  var classList = Array.prototype.slice.call(node.classList);\n  var style = {};\n  // DOM style is a CSSStyleDeclaration\n  // https://developer.mozilla.org/en-US/docs/Web/API/CSSStyleDeclaration\n  for (var i = 0; i < nodeStyle.length; i += 1) {\n    var property = nodeStyle.item(i);\n    if (property) {\n      // DOM style uses hyphenated prop names and may include vendor prefixes\n      // Transform back into React DOM style.\n      style[toCamelCase(property)] = nodeStyle.getPropertyValue(property);\n    }\n  }\n  return { classList: classList, style: style };\n};"]},"metadata":{},"sourceType":"module"}