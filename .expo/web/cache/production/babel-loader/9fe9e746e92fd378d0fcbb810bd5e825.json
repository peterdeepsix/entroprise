{"ast":null,"code":"import _extends from\"@babel/runtime/helpers/extends\";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}import performanceNow from'fbjs/lib/performanceNow';import warning from'fbjs/lib/warning';var Info=function Info(){_classCallCheck(this,Info);this.any_blank_count=0;this.any_blank_ms=0;this.any_blank_speed_sum=0;this.mostly_blank_count=0;this.mostly_blank_ms=0;this.pixels_blank=0;this.pixels_sampled=0;this.pixels_scrolled=0;this.total_time_spent=0;this.sample_count=0;};var DEBUG=false;var _listeners=[];var _minSampleCount=10;var _sampleRate=DEBUG?1:null;var FillRateHelper=function(){FillRateHelper.addListener=function addListener(callback){warning(_sampleRate!==null,'Call `FillRateHelper.setSampleRate` before `addListener`.');_listeners.push(callback);return{remove:function remove(){_listeners=_listeners.filter(function(listener){return callback!==listener;});}};};FillRateHelper.setSampleRate=function setSampleRate(sampleRate){_sampleRate=sampleRate;};FillRateHelper.setMinSampleCount=function setMinSampleCount(minSampleCount){_minSampleCount=minSampleCount;};function FillRateHelper(getFrameMetrics){_classCallCheck(this,FillRateHelper);this._anyBlankStartTime=null;this._enabled=false;this._info=new Info();this._mostlyBlankStartTime=null;this._samplesStartTime=null;this._getFrameMetrics=getFrameMetrics;this._enabled=(_sampleRate||0)>Math.random();this._resetData();}FillRateHelper.prototype.activate=function activate(){if(this._enabled&&this._samplesStartTime==null){DEBUG&&console.debug('FillRateHelper: activate');this._samplesStartTime=performanceNow();}};FillRateHelper.prototype.deactivateAndFlush=function deactivateAndFlush(){if(!this._enabled){return;}var start=this._samplesStartTime;if(start==null){DEBUG&&console.debug('FillRateHelper: bail on deactivate with no start time');return;}if(this._info.sample_count<_minSampleCount){this._resetData();return;}var total_time_spent=performanceNow()-start;var info=_extends({},this._info,{total_time_spent:total_time_spent});if(DEBUG){var derived={avg_blankness:this._info.pixels_blank/this._info.pixels_sampled,avg_speed:this._info.pixels_scrolled/(total_time_spent/1000),avg_speed_when_any_blank:this._info.any_blank_speed_sum/this._info.any_blank_count,any_blank_per_min:this._info.any_blank_count/(total_time_spent/1000/60),any_blank_time_frac:this._info.any_blank_ms/total_time_spent,mostly_blank_per_min:this._info.mostly_blank_count/(total_time_spent/1000/60),mostly_blank_time_frac:this._info.mostly_blank_ms/total_time_spent};for(var key in derived){derived[key]=Math.round(1000*derived[key])/1000;}console.debug('FillRateHelper deactivateAndFlush: ',{derived:derived,info:info});}_listeners.forEach(function(listener){return listener(info);});this._resetData();};FillRateHelper.prototype.computeBlankness=function computeBlankness(props,state,scrollMetrics){if(!this._enabled||props.getItemCount(props.data)===0||this._samplesStartTime==null){return 0;}var dOffset=scrollMetrics.dOffset,offset=scrollMetrics.offset,velocity=scrollMetrics.velocity,visibleLength=scrollMetrics.visibleLength;this._info.sample_count++;this._info.pixels_sampled+=Math.round(visibleLength);this._info.pixels_scrolled+=Math.round(Math.abs(dOffset));var scrollSpeed=Math.round(Math.abs(velocity)*1000);var now=performanceNow();if(this._anyBlankStartTime!=null){this._info.any_blank_ms+=now-this._anyBlankStartTime;}this._anyBlankStartTime=null;if(this._mostlyBlankStartTime!=null){this._info.mostly_blank_ms+=now-this._mostlyBlankStartTime;}this._mostlyBlankStartTime=null;var blankTop=0;var first=state.first;var firstFrame=this._getFrameMetrics(first);while(first<=state.last&&(!firstFrame||!firstFrame.inLayout)){firstFrame=this._getFrameMetrics(first);first++;}if(firstFrame&&first>0){blankTop=Math.min(visibleLength,Math.max(0,firstFrame.offset-offset));}var blankBottom=0;var last=state.last;var lastFrame=this._getFrameMetrics(last);while(last>=state.first&&(!lastFrame||!lastFrame.inLayout)){lastFrame=this._getFrameMetrics(last);last--;}if(lastFrame&&last<props.getItemCount(props.data)-1){var bottomEdge=lastFrame.offset+lastFrame.length;blankBottom=Math.min(visibleLength,Math.max(0,offset+visibleLength-bottomEdge));}var pixels_blank=Math.round(blankTop+blankBottom);var blankness=pixels_blank/visibleLength;if(blankness>0){this._anyBlankStartTime=now;this._info.any_blank_speed_sum+=scrollSpeed;this._info.any_blank_count++;this._info.pixels_blank+=pixels_blank;if(blankness>0.5){this._mostlyBlankStartTime=now;this._info.mostly_blank_count++;}}else if(scrollSpeed<0.01||Math.abs(dOffset)<1){this.deactivateAndFlush();}return blankness;};FillRateHelper.prototype.enabled=function enabled(){return this._enabled;};FillRateHelper.prototype._resetData=function _resetData(){this._anyBlankStartTime=null;this._info=new Info();this._mostlyBlankStartTime=null;this._samplesStartTime=null;};return FillRateHelper;}();export default FillRateHelper;","map":{"version":3,"sources":["C:/Users/arnol/code/entroprise/node_modules/react-web-gifted-chat/node_modules/react-native-web/dist/vendor/react-native/FillRateHelper/index.js"],"names":["_classCallCheck","instance","Constructor","TypeError","performanceNow","warning","Info","any_blank_count","any_blank_ms","any_blank_speed_sum","mostly_blank_count","mostly_blank_ms","pixels_blank","pixels_sampled","pixels_scrolled","total_time_spent","sample_count","DEBUG","_listeners","_minSampleCount","_sampleRate","FillRateHelper","addListener","callback","push","remove","filter","listener","setSampleRate","sampleRate","setMinSampleCount","minSampleCount","getFrameMetrics","_anyBlankStartTime","_enabled","_info","_mostlyBlankStartTime","_samplesStartTime","_getFrameMetrics","Math","random","_resetData","prototype","activate","console","debug","deactivateAndFlush","start","info","derived","avg_blankness","avg_speed","avg_speed_when_any_blank","any_blank_per_min","any_blank_time_frac","mostly_blank_per_min","mostly_blank_time_frac","key","round","forEach","computeBlankness","props","state","scrollMetrics","getItemCount","data","dOffset","offset","velocity","visibleLength","abs","scrollSpeed","now","blankTop","first","firstFrame","last","inLayout","min","max","blankBottom","lastFrame","bottomEdge","length","blankness","enabled"],"mappings":"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","sourcesContent":["function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Copyright (c) 2015-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n * @format\n */\n\nimport performanceNow from 'fbjs/lib/performanceNow';\nimport warning from 'fbjs/lib/warning';\n\nvar Info = function Info() {\n  _classCallCheck(this, Info);\n\n  this.any_blank_count = 0;\n  this.any_blank_ms = 0;\n  this.any_blank_speed_sum = 0;\n  this.mostly_blank_count = 0;\n  this.mostly_blank_ms = 0;\n  this.pixels_blank = 0;\n  this.pixels_sampled = 0;\n  this.pixels_scrolled = 0;\n  this.total_time_spent = 0;\n  this.sample_count = 0;\n};\n\nvar DEBUG = false;\n\nvar _listeners = [];\nvar _minSampleCount = 10;\nvar _sampleRate = DEBUG ? 1 : null;\n\n/**\n * A helper class for detecting when the maximem fill rate of `VirtualizedList` is exceeded.\n * By default the sampling rate is set to zero and this will do nothing. If you want to collect\n * samples (e.g. to log them), make sure to call `FillRateHelper.setSampleRate(0.0-1.0)`.\n *\n * Listeners and sample rate are global for all `VirtualizedList`s - typical usage will combine with\n * `SceneTracker.getActiveScene` to determine the context of the events.\n */\n\nvar FillRateHelper = function () {\n  FillRateHelper.addListener = function addListener(callback) {\n    warning(_sampleRate !== null, 'Call `FillRateHelper.setSampleRate` before `addListener`.');\n    _listeners.push(callback);\n    return {\n      remove: function remove() {\n        _listeners = _listeners.filter(function (listener) {\n          return callback !== listener;\n        });\n      }\n    };\n  };\n\n  FillRateHelper.setSampleRate = function setSampleRate(sampleRate) {\n    _sampleRate = sampleRate;\n  };\n\n  FillRateHelper.setMinSampleCount = function setMinSampleCount(minSampleCount) {\n    _minSampleCount = minSampleCount;\n  };\n\n  function FillRateHelper(getFrameMetrics) {\n    _classCallCheck(this, FillRateHelper);\n\n    this._anyBlankStartTime = null;\n    this._enabled = false;\n    this._info = new Info();\n    this._mostlyBlankStartTime = null;\n    this._samplesStartTime = null;\n\n    this._getFrameMetrics = getFrameMetrics;\n    this._enabled = (_sampleRate || 0) > Math.random();\n    this._resetData();\n  }\n\n  FillRateHelper.prototype.activate = function activate() {\n    if (this._enabled && this._samplesStartTime == null) {\n      DEBUG && console.debug('FillRateHelper: activate');\n      this._samplesStartTime = performanceNow();\n    }\n  };\n\n  FillRateHelper.prototype.deactivateAndFlush = function deactivateAndFlush() {\n    if (!this._enabled) {\n      return;\n    }\n    var start = this._samplesStartTime; // const for flow\n    if (start == null) {\n      DEBUG && console.debug('FillRateHelper: bail on deactivate with no start time');\n      return;\n    }\n    if (this._info.sample_count < _minSampleCount) {\n      // Don't bother with under-sampled events.\n      this._resetData();\n      return;\n    }\n    var total_time_spent = performanceNow() - start;\n    var info = Object.assign({}, this._info, {\n      total_time_spent: total_time_spent\n    });\n    if (DEBUG) {\n      var derived = {\n        avg_blankness: this._info.pixels_blank / this._info.pixels_sampled,\n        avg_speed: this._info.pixels_scrolled / (total_time_spent / 1000),\n        avg_speed_when_any_blank: this._info.any_blank_speed_sum / this._info.any_blank_count,\n        any_blank_per_min: this._info.any_blank_count / (total_time_spent / 1000 / 60),\n        any_blank_time_frac: this._info.any_blank_ms / total_time_spent,\n        mostly_blank_per_min: this._info.mostly_blank_count / (total_time_spent / 1000 / 60),\n        mostly_blank_time_frac: this._info.mostly_blank_ms / total_time_spent\n      };\n      for (var key in derived) {\n        derived[key] = Math.round(1000 * derived[key]) / 1000;\n      }\n      console.debug('FillRateHelper deactivateAndFlush: ', { derived: derived, info: info });\n    }\n    _listeners.forEach(function (listener) {\n      return listener(info);\n    });\n    this._resetData();\n  };\n\n  FillRateHelper.prototype.computeBlankness = function computeBlankness(props, state, scrollMetrics) {\n    if (!this._enabled || props.getItemCount(props.data) === 0 || this._samplesStartTime == null) {\n      return 0;\n    }\n    var dOffset = scrollMetrics.dOffset,\n        offset = scrollMetrics.offset,\n        velocity = scrollMetrics.velocity,\n        visibleLength = scrollMetrics.visibleLength;\n\n    // Denominator metrics that we track for all events - most of the time there is no blankness and\n    // we want to capture that.\n\n    this._info.sample_count++;\n    this._info.pixels_sampled += Math.round(visibleLength);\n    this._info.pixels_scrolled += Math.round(Math.abs(dOffset));\n    var scrollSpeed = Math.round(Math.abs(velocity) * 1000); // px / sec\n\n    // Whether blank now or not, record the elapsed time blank if we were blank last time.\n    var now = performanceNow();\n    if (this._anyBlankStartTime != null) {\n      this._info.any_blank_ms += now - this._anyBlankStartTime;\n    }\n    this._anyBlankStartTime = null;\n    if (this._mostlyBlankStartTime != null) {\n      this._info.mostly_blank_ms += now - this._mostlyBlankStartTime;\n    }\n    this._mostlyBlankStartTime = null;\n\n    var blankTop = 0;\n    var first = state.first;\n    var firstFrame = this._getFrameMetrics(first);\n    while (first <= state.last && (!firstFrame || !firstFrame.inLayout)) {\n      firstFrame = this._getFrameMetrics(first);\n      first++;\n    }\n    // Only count blankTop if we aren't rendering the first item, otherwise we will count the header\n    // as blank.\n    if (firstFrame && first > 0) {\n      blankTop = Math.min(visibleLength, Math.max(0, firstFrame.offset - offset));\n    }\n    var blankBottom = 0;\n    var last = state.last;\n    var lastFrame = this._getFrameMetrics(last);\n    while (last >= state.first && (!lastFrame || !lastFrame.inLayout)) {\n      lastFrame = this._getFrameMetrics(last);\n      last--;\n    }\n    // Only count blankBottom if we aren't rendering the last item, otherwise we will count the\n    // footer as blank.\n    if (lastFrame && last < props.getItemCount(props.data) - 1) {\n      var bottomEdge = lastFrame.offset + lastFrame.length;\n      blankBottom = Math.min(visibleLength, Math.max(0, offset + visibleLength - bottomEdge));\n    }\n    var pixels_blank = Math.round(blankTop + blankBottom);\n    var blankness = pixels_blank / visibleLength;\n    if (blankness > 0) {\n      this._anyBlankStartTime = now;\n      this._info.any_blank_speed_sum += scrollSpeed;\n      this._info.any_blank_count++;\n      this._info.pixels_blank += pixels_blank;\n      if (blankness > 0.5) {\n        this._mostlyBlankStartTime = now;\n        this._info.mostly_blank_count++;\n      }\n    } else if (scrollSpeed < 0.01 || Math.abs(dOffset) < 1) {\n      this.deactivateAndFlush();\n    }\n    return blankness;\n  };\n\n  FillRateHelper.prototype.enabled = function enabled() {\n    return this._enabled;\n  };\n\n  FillRateHelper.prototype._resetData = function _resetData() {\n    this._anyBlankStartTime = null;\n    this._info = new Info();\n    this._mostlyBlankStartTime = null;\n    this._samplesStartTime = null;\n  };\n\n  return FillRateHelper;\n}();\n\nexport default FillRateHelper;"]},"metadata":{},"sourceType":"module"}