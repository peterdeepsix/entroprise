{"ast":null,"code":"import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{useState,useEffect}from\"react\";import Video from\"twilio-video\";import Participant from\"./Participant\";var Room=function Room(_ref){var roomName=_ref.roomName,token=_ref.token,handleLogout=_ref.handleLogout;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),room=_useState2[0],setRoom=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),participants=_useState4[0],setParticipants=_useState4[1];useEffect(function(){var participantConnected=function participantConnected(participant){setParticipants(function(prevParticipants){return[].concat(_toConsumableArray(prevParticipants),[participant]);});};var participantDisconnected=function participantDisconnected(participant){setParticipants(function(prevParticipants){return prevParticipants.filter(function(p){return p!==participant;});});};Video.connect(token,{name:roomName}).then(function(room){setRoom(room);room.on(\"participantConnected\",participantConnected);room.on(\"participantDisconnected\",participantDisconnected);room.participants.forEach(participantConnected);});return function(){setRoom(function(currentRoom){if(currentRoom&&currentRoom.localParticipant.state===\"connected\"){currentRoom.localParticipant.tracks.forEach(function(trackPublication){trackPublication.track.stop();});currentRoom.disconnect();return null;}else{return currentRoom;}});};},[roomName,token]);var remoteParticipants=participants.map(function(participant){return React.createElement(Participant,{key:participant.sid,participant:participant});});return React.createElement(\"div\",{className:\"room\"},React.createElement(\"h2\",null,\"Room: \",roomName),React.createElement(\"button\",{onClick:handleLogout},\"Log out\"),React.createElement(\"div\",{className:\"local-participant\"},room?React.createElement(Participant,{key:room.localParticipant.sid,participant:room.localParticipant}):\"\"),React.createElement(\"h3\",null,\"Remote Participants\"),React.createElement(\"div\",{className:\"remote-participants\"},remoteParticipants));};export default Room;","map":{"version":3,"sources":["C:/Users/arnol/code/entroprise/src/components/ServicePage/Room.js"],"names":["React","useState","useEffect","Video","Participant","Room","roomName","token","handleLogout","room","setRoom","participants","setParticipants","participantConnected","participant","prevParticipants","participantDisconnected","filter","p","connect","name","then","on","forEach","currentRoom","localParticipant","state","tracks","trackPublication","track","stop","disconnect","remoteParticipants","map","sid"],"mappings":"0IAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,KAAP,KAAkB,cAAlB,CACA,MAAOC,CAAAA,WAAP,qBAEA,GAAMC,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,MAAuC,IAApCC,CAAAA,QAAoC,MAApCA,QAAoC,CAA1BC,KAA0B,MAA1BA,KAA0B,CAAnBC,YAAmB,MAAnBA,YAAmB,eAC1BP,QAAQ,CAAC,IAAD,CADkB,wCAC3CQ,IAD2C,eACrCC,OADqC,8BAEVT,QAAQ,CAAC,EAAD,CAFE,yCAE3CU,YAF2C,eAE7BC,eAF6B,eAIlDV,SAAS,CAAC,UAAM,CACd,GAAMW,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,CAAAC,WAAW,CAAI,CAC1CF,eAAe,CAAC,SAAAG,gBAAgB,qCAAQA,gBAAR,GAA0BD,WAA1B,IAAjB,CAAf,CACD,CAFD,CAIA,GAAME,CAAAA,uBAAuB,CAAG,QAA1BA,CAAAA,uBAA0B,CAAAF,WAAW,CAAI,CAC7CF,eAAe,CAAC,SAAAG,gBAAgB,QAC9BA,CAAAA,gBAAgB,CAACE,MAAjB,CAAwB,SAAAC,CAAC,QAAIA,CAAAA,CAAC,GAAKJ,WAAV,EAAzB,CAD8B,EAAjB,CAAf,CAGD,CAJD,CAMAX,KAAK,CAACgB,OAAN,CAAcZ,KAAd,CAAqB,CACnBa,IAAI,CAAEd,QADa,CAArB,EAEGe,IAFH,CAEQ,SAAAZ,IAAI,CAAI,CACdC,OAAO,CAACD,IAAD,CAAP,CACAA,IAAI,CAACa,EAAL,CAAQ,sBAAR,CAAgCT,oBAAhC,EACAJ,IAAI,CAACa,EAAL,CAAQ,yBAAR,CAAmCN,uBAAnC,EACAP,IAAI,CAACE,YAAL,CAAkBY,OAAlB,CAA0BV,oBAA1B,EACD,CAPD,EASA,MAAO,WAAM,CACXH,OAAO,CAAC,SAAAc,WAAW,CAAI,CACrB,GAAIA,WAAW,EAAIA,WAAW,CAACC,gBAAZ,CAA6BC,KAA7B,GAAuC,WAA1D,CAAuE,CACrEF,WAAW,CAACC,gBAAZ,CAA6BE,MAA7B,CAAoCJ,OAApC,CAA4C,SAC1CK,gBAD0C,CAE1C,CACAA,gBAAgB,CAACC,KAAjB,CAAuBC,IAAvB,GACD,CAJD,EAKAN,WAAW,CAACO,UAAZ,GACA,MAAO,KAAP,CACD,CARD,IAQO,CACL,MAAOP,CAAAA,WAAP,CACD,CACF,CAZM,CAAP,CAaD,CAdD,CAeD,CAnCQ,CAmCN,CAAClB,QAAD,CAAWC,KAAX,CAnCM,CAAT,CAqCA,GAAMyB,CAAAA,kBAAkB,CAAGrB,YAAY,CAACsB,GAAb,CAAiB,SAAAnB,WAAW,QACrD,qBAAC,WAAD,EAAa,GAAG,CAAEA,WAAW,CAACoB,GAA9B,CAAmC,WAAW,CAAEpB,WAAhD,EADqD,EAA5B,CAA3B,CAIA,MACE,4BAAK,SAAS,CAAC,MAAf,EACE,uCAAWR,QAAX,CADF,CAEE,8BAAQ,OAAO,CAAEE,YAAjB,YAFF,CAGE,2BAAK,SAAS,CAAC,mBAAf,EACGC,IAAI,CACH,oBAAC,WAAD,EACE,GAAG,CAAEA,IAAI,CAACgB,gBAAL,CAAsBS,GAD7B,CAEE,WAAW,CAAEzB,IAAI,CAACgB,gBAFpB,EADG,CAMH,EAPJ,CAHF,CAaE,oDAbF,CAcE,2BAAK,SAAS,CAAC,qBAAf,EAAsCO,kBAAtC,CAdF,CADF,CAkBD,CA/DD,CAiEA,cAAe3B,CAAAA,IAAf","sourcesContent":["import React, { useState, useEffect } from \"react\"\r\nimport Video from \"twilio-video\"\r\nimport Participant from \"./Participant\"\r\n\r\nconst Room = ({ roomName, token, handleLogout }) => {\r\n  const [room, setRoom] = useState(null)\r\n  const [participants, setParticipants] = useState([])\r\n\r\n  useEffect(() => {\r\n    const participantConnected = participant => {\r\n      setParticipants(prevParticipants => [...prevParticipants, participant])\r\n    }\r\n\r\n    const participantDisconnected = participant => {\r\n      setParticipants(prevParticipants =>\r\n        prevParticipants.filter(p => p !== participant)\r\n      )\r\n    }\r\n\r\n    Video.connect(token, {\r\n      name: roomName,\r\n    }).then(room => {\r\n      setRoom(room)\r\n      room.on(\"participantConnected\", participantConnected)\r\n      room.on(\"participantDisconnected\", participantDisconnected)\r\n      room.participants.forEach(participantConnected)\r\n    })\r\n\r\n    return () => {\r\n      setRoom(currentRoom => {\r\n        if (currentRoom && currentRoom.localParticipant.state === \"connected\") {\r\n          currentRoom.localParticipant.tracks.forEach(function(\r\n            trackPublication\r\n          ) {\r\n            trackPublication.track.stop()\r\n          })\r\n          currentRoom.disconnect()\r\n          return null\r\n        } else {\r\n          return currentRoom\r\n        }\r\n      })\r\n    }\r\n  }, [roomName, token])\r\n\r\n  const remoteParticipants = participants.map(participant => (\r\n    <Participant key={participant.sid} participant={participant} />\r\n  ))\r\n\r\n  return (\r\n    <div className=\"room\">\r\n      <h2>Room: {roomName}</h2>\r\n      <button onClick={handleLogout}>Log out</button>\r\n      <div className=\"local-participant\">\r\n        {room ? (\r\n          <Participant\r\n            key={room.localParticipant.sid}\r\n            participant={room.localParticipant}\r\n          />\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </div>\r\n      <h3>Remote Participants</h3>\r\n      <div className=\"remote-participants\">{remoteParticipants}</div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Room\r\n"]},"metadata":{},"sourceType":"module"}