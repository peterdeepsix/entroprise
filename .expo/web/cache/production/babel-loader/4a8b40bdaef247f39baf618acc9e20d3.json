{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{useState,useCallback}from\"react\";import Lobby from\"./Lobby\";import Room from\"./Room\";var VideoChat=function VideoChat(_ref){var user=_ref.user;var uid=user.uid;var _useState=useState(\"default\"),_useState2=_slicedToArray(_useState,2),roomName=_useState2[0],setRoomName=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),token=_useState4[0],setToken=_useState4[1];var handleRoomNameChange=useCallback(function(event){setRoomName(event.target.value);},[]);var handleSubmit=useCallback(function _callee(event){var fetchAsync;return _regeneratorRuntime.async(function _callee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:fetchAsync=function _ref2(){var response,data;return _regeneratorRuntime.async(function fetchAsync$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(fetch(\"https://us-central1-entroprise-production.cloudfunctions.net/token\",{method:\"POST\",body:JSON.stringify({identity:uid,roomName:roomName}),headers:{\"Content-Type\":\"application/json\"}}));case 2:response=_context.sent;_context.next=5;return _regeneratorRuntime.awrap(response.json());case 5:data=_context.sent;return _context.abrupt(\"return\",data);case 7:case\"end\":return _context.stop();}}},null,null,null,Promise);};event.preventDefault();fetchAsync().then(function(data){setToken(data.token);}).catch(function(reason){return console.log(reason.message);});case 3:case\"end\":return _context2.stop();}}},null,null,null,Promise);},[roomName,uid]);var handleLogout=useCallback(function(event){setToken(null);},[]);var render;if(token){console.log(token);render=React.createElement(Room,{roomName:roomName,token:token,handleLogout:handleLogout});}else{render=React.createElement(Lobby,{roomName:roomName,handleRoomNameChange:handleRoomNameChange,handleSubmit:handleSubmit});}return render;};export default VideoChat;","map":{"version":3,"sources":["C:/Users/arnol/code/entroprise/src/components/ServicePage/VideoChat.js"],"names":["React","useState","useCallback","Lobby","Room","VideoChat","user","uid","roomName","setRoomName","token","setToken","handleRoomNameChange","event","target","value","handleSubmit","fetchAsync","fetch","method","body","JSON","stringify","identity","headers","response","json","data","preventDefault","then","catch","reason","console","log","message","handleLogout","render"],"mappings":"6HAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,WAA1B,KAA6C,OAA7C,CACA,MAAOC,CAAAA,KAAP,eACA,MAAOC,CAAAA,IAAP,cAEA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,MAAc,IAAXC,CAAAA,IAAW,MAAXA,IAAW,IACtBC,CAAAA,GADsB,CACdD,IADc,CACtBC,GADsB,eAEEN,QAAQ,CAAC,SAAD,CAFV,wCAEvBO,QAFuB,eAEbC,WAFa,8BAGJR,QAAQ,EAHJ,yCAGvBS,KAHuB,eAGhBC,QAHgB,eAK9B,GAAMC,CAAAA,oBAAoB,CAAGV,WAAW,CAAC,SAAAW,KAAK,CAAI,CAChDJ,WAAW,CAACI,KAAK,CAACC,MAAN,CAAaC,KAAd,CAAX,CACD,CAFuC,CAErC,EAFqC,CAAxC,CAIA,GAAMC,CAAAA,YAAY,CAAGd,WAAW,CAC9B,iBAAMW,KAAN,KAGiBI,CAAAA,UAHjB,qHAGiBA,UAHjB,yMAIyBC,KAAK,CACxB,oEADwB,CAExB,CACEC,MAAM,CAAE,MADV,CAEEC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACnBC,QAAQ,CAAEhB,GADS,CAEnBC,QAAQ,CAAEA,QAFS,CAAf,CAFR,CAMEgB,OAAO,CAAE,CACP,eAAgB,kBADT,CANX,CAFwB,CAJ9B,SAIQC,QAJR,gEAiBqBA,QAAQ,CAACC,IAAT,EAjBrB,SAiBQC,IAjBR,+CAkBWA,IAlBX,wEACEd,KAAK,CAACe,cAAN,GAoBAX,UAAU,GACPY,IADH,CACQ,SAAAF,IAAI,CAAI,CACZhB,QAAQ,CAACgB,IAAI,CAACjB,KAAN,CAAR,CACD,CAHH,EAIGoB,KAJH,CAIS,SAAAC,MAAM,QAAIC,CAAAA,OAAO,CAACC,GAAR,CAAYF,MAAM,CAACG,OAAnB,CAAJ,EAJf,EArBF,sEAD8B,CA4B9B,CAAC1B,QAAD,CAAWD,GAAX,CA5B8B,CAAhC,CA+BA,GAAM4B,CAAAA,YAAY,CAAGjC,WAAW,CAAC,SAAAW,KAAK,CAAI,CACxCF,QAAQ,CAAC,IAAD,CAAR,CACD,CAF+B,CAE7B,EAF6B,CAAhC,CAIA,GAAIyB,CAAAA,MAAJ,CACA,GAAI1B,KAAJ,CAAW,CACTsB,OAAO,CAACC,GAAR,CAAYvB,KAAZ,EACA0B,MAAM,CACJ,oBAAC,IAAD,EAAM,QAAQ,CAAE5B,QAAhB,CAA0B,KAAK,CAAEE,KAAjC,CAAwC,YAAY,CAAEyB,YAAtD,EADF,CAGD,CALD,IAKO,CACLC,MAAM,CACJ,oBAAC,KAAD,EACE,QAAQ,CAAE5B,QADZ,CAEE,oBAAoB,CAAEI,oBAFxB,CAGE,YAAY,CAAEI,YAHhB,EADF,CAOD,CACD,MAAOoB,CAAAA,MAAP,CACD,CA5DD,CA8DA,cAAe/B,CAAAA,SAAf","sourcesContent":["import React, { useState, useCallback } from \"react\"\r\nimport Lobby from \"./Lobby\"\r\nimport Room from \"./Room\"\r\n\r\nconst VideoChat = ({ user }) => {\r\n  const { uid } = user\r\n  const [roomName, setRoomName] = useState(\"default\")\r\n  const [token, setToken] = useState()\r\n\r\n  const handleRoomNameChange = useCallback(event => {\r\n    setRoomName(event.target.value)\r\n  }, [])\r\n\r\n  const handleSubmit = useCallback(\r\n    async event => {\r\n      event.preventDefault()\r\n\r\n      async function fetchAsync() {\r\n        let response = await fetch(\r\n          \"https://us-central1-entroprise-production.cloudfunctions.net/token\",\r\n          {\r\n            method: \"POST\",\r\n            body: JSON.stringify({\r\n              identity: uid,\r\n              roomName: roomName,\r\n            }),\r\n            headers: {\r\n              \"Content-Type\": \"application/json\",\r\n            },\r\n          }\r\n        )\r\n        let data = await response.json()\r\n        return data\r\n      }\r\n\r\n      fetchAsync()\r\n        .then(data => {\r\n          setToken(data.token)\r\n        })\r\n        .catch(reason => console.log(reason.message))\r\n    },\r\n    [roomName, uid]\r\n  )\r\n\r\n  const handleLogout = useCallback(event => {\r\n    setToken(null)\r\n  }, [])\r\n\r\n  let render\r\n  if (token) {\r\n    console.log(token)\r\n    render = (\r\n      <Room roomName={roomName} token={token} handleLogout={handleLogout} />\r\n    )\r\n  } else {\r\n    render = (\r\n      <Lobby\r\n        roomName={roomName}\r\n        handleRoomNameChange={handleRoomNameChange}\r\n        handleSubmit={handleSubmit}\r\n      />\r\n    )\r\n  }\r\n  return render\r\n}\r\n\r\nexport default VideoChat\r\n"]},"metadata":{},"sourceType":"module"}